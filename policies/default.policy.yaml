version: 1

# runtime.instance_id is included in policyHash to avoid accidental run_id collisions
# across multiple gateway deployments sharing the same database.
runtime:
  instance_id: "local"

# Default policy is intentionally conservative and deterministic.
# Tighten further for multi-tenant deployments.

tool_allowlist:
  - artifact_import
  - artifact_get
  - artifact_list
  - artifact_preview_text
  - docker_job_get
  - simulate_qc_fastq
  - simulate_align_reads
  - seqkit_stats
  - samtools_flagstat
  - fastqc
  - multiqc
  - qc_bundle_fastq
  - export_nextflow

quotas:
  max_threads: 16
  max_runtime_seconds: 3600
  max_import_bytes: 10737418240 # 10 GiB
  max_preview_bytes: 8192
  max_preview_lines: 200

imports:
  allow_source_kinds: ["inline_text", "local_path"]
  local_path_prefix_allowlist:
    - "/tmp"
    - "var/import"
    - "${GATEWAY_IMPORT_ROOT}"
  deny_symlinks: true

tools:
  simulate_align_reads:
    max_threads: 16
  simulate_qc_fastq:
    max_threads: 8
  fastqc:
    max_threads: 4
  multiqc:
    max_threads: 8

docker:
  network_mode: "none"
  image_allowlist:
    - "quay.io/biocontainers/seqkit@sha256:67c9a1cfeafbccfd43bbd1fbb80646c9faa06a50b22c8ea758c3c84268b6765d"
    - "quay.io/biocontainers/samtools@sha256:bf80e07e650becfd084db1abde0fe932b50f990a07fa56421ea647b552b5a406"
    - "quay.io/biocontainers/fastqc@sha256:e194048df39c3145d9b4e0a14f4da20b59d59250465b6f2a9cb698445fd45900"
    - "quay.io/biocontainers/multiqc@sha256:ecafca93ba3346775b773bbfd6ff920ecfc259f554777576c15d3139c678311b"
